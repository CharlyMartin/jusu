{"version":3,"sources":["javascript/components/block.js","javascript/initialisers/init-counter.js","javascript/airtable/secret.js","javascript/airtable/client.js","javascript/helpers/random-number.js","javascript/initialisers/init-quote.js","javascript/initialisers/init-principle.js","javascript/app.js"],"names":["AppBlock","root","attachShadow","mode","template","document","querySelector","appendChild","content","cloneNode","title","getAttribute","text","class","header","paragraph","innerText","classList","add","el","newVal","console","log","name","oldValue","newValue","updateElement","init","HTMLElement","bDay","bMonth","bYear","firstName","component","isBirthdayToday","today","Date","getDate","getMonth","isBirthdayAhead","currentYear","getFullYear","time","oneYearPeriod","lastY","nextY","getTimeSinceLastBirthday","timeSinceLastBirthday","now","percentage","output","substring","setTitle","setAttribute","setText","lastBirthday","nextBirthday","airtableKey","tables","baseUrl","headers","credentials","lastIdParams","fields","sortField","sortDirection","maxRecords","getLastRecordId","tableName","url","Object","values","join","fetch","then","response","json","records","getDataFrom","id","randomNumber","max","Math","ceil","random","lastId","randomId","data","Author","Quote","Id","Title","Principle","window","customElements","define","setInterval"],"mappings":"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","file":"app.26584510.map","sourceRoot":"..","sourcesContent":["class AppBlock extends HTMLElement {\n  constructor() {\n    // Calling the constructor() of HTMLElement\n    super();\n\n    // Using instances as roots of Shadow DOM\n    this.root = this.attachShadow({mode: 'open'})\n    \n    // Using an HTML fragent and cloning for each instance:\n    const template = document.querySelector('template');\n    this.root.appendChild(template.content.cloneNode(true));\n    \n\n    // Web Component's attributes:\n    this.title = this.getAttribute('title');\n    this.text = this.getAttribute('text');\n    this.class = this.getAttribute('class');\n\n    // HTML elements from the template:\n    this.header = this.root.querySelector('.title');\n    this.paragraph = this.root.querySelector('.text');\n  }\n\n  static get observedAttributes() {\n    return ['title', 'text', 'class'];\n    // By default custom elements do not listen to changes.\n    // This is listening to changes in the instances' attributes.\n  }\n\n  init() {\n    this.header.innerText = this.title;\n    this.paragraph.innerText = this.text;\n    this.paragraph.classList.add(this.class);\n    // Using attribute values to fill the content of the component's children;\n  }\n\n  updateElement(el, newVal) {\n    el.innerText = newVal;\n  }\n\n  updateClass(el, newVal) {\n    console.log(el);\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    // console.log(`${name} attribute changed`);\n\n    if (name === 'title') {\n      this.updateElement(this.header, newValue);\n    };\n\n    if (name === 'text') {\n      this.updateElement(this.paragraph, newValue);\n    };\n  }\n\n  connectedCallback() {\n    // console.log(`${this.title} added to the DOM.`);\n    this.init();\n  }\n\n  disconnectedCallback() {\n    // console.log(`${this.title} removed from the DOM.`);\n  }\n}\n\nexport { AppBlock };","const bDay = 12;\nconst bMonth = 6 // JS starts counting month at 0;\nconst bYear = 1990;\nconst firstName = 'Charly';\nconst component = document.querySelector('#counter > app-block');\n\n\nfunction isBirthdayToday() {\n  const today = `${new Date().getDate()}/${new Date().getMonth()}`\n  return today === `${bDay}/${bMonth}`;\n}\n\nfunction isBirthdayAhead() {\n  // Is this year's birthday ahead ?\n  const currentYear = new Date().getFullYear();\n  const time = new Date(currentYear, bMonth, bDay) - new Date();\n  return (time > 0);\n}\n\nfunction oneYearPeriod(lastY, nextY) {\n  return new Date(nextY, bMonth, bDay) - new Date(lastY, bMonth, bDay);\n}\n\nfunction getTimeSinceLastBirthday(lastY, nextY) {\n  const timeSinceLastBirthday = Date.now() - new Date(lastY, bMonth, bDay);\n  const percentage = (timeSinceLastBirthday / oneYearPeriod(lastY, nextY)) * 100;\n  const output = `${percentage}`.substring(0, 10);\n  return `${output} %`;\n}\n\nfunction currentYear() {\n  const currentYear = new Date().getFullYear() - bYear;\n  if (isBirthdayAhead()) {return currentYear};\n  return currentYear + 1;\n}\n\nfunction setTitle() {\n  if (isBirthdayAhead()) {\n    component.setAttribute('title', `Progress of your ${currentYear()}th year`);\n  }\n  \n}\n\nfunction setText() {\n  if (isBirthdayToday()) {\n    component.setAttribute('text', `Happy Birthday ${firstName} 🎉`);\n    return\n  }\n\n  if (isBirthdayAhead()) {\n    const lastBirthday = new Date().getFullYear() - 1;\n    const nextBirthday = new Date().getFullYear();\n    component.setAttribute('text', getTimeSinceLastBirthday(lastBirthday, nextBirthday));\n    return;\n  }\n\n  const lastBirthday = new Date().getFullYear();\n  const nextBirthday = new Date().getFullYear() + 1;\n  component.setAttribute('text', getTimeSinceLastBirthday(lastBirthday, nextBirthday));\n}\n\n\nexport { setText, setTitle };\n\n\n","const airtableKey = 'keyLJFjUKsl2jfxfA';\n\nconst tables = {\n  'Quotes': 'appB3NhaDjZBZ6g37',\n  'Principles': 'app8rNOuT6IXnW8Gv'\n}\n\nexport { airtableKey, tables };","import { airtableKey, tables } from './secret.js';\nconst baseUrl = 'https://api.airtable.com/v0';\n\nconst headers = {\n  mode: \"cors\",\n  credentials: \"same-origin\",\n  headers: {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\" : `Bearer ${airtableKey}`\n  }\n}\n\nconst lastIdParams = {\n  fields: 'fields[]=Id',\n  sortField: 'sort[0][field]=Created',\n  sortDirection: 'sort[0][direction]=desc',\n  maxRecords: 'maxRecords=1'\n}\n\nfunction getLastRecordId(tableName) {\n  const url = `${baseUrl}/${tables[tableName]}/${tableName}?${Object.values(lastIdParams).join('&')}`;\n  \n  return fetch(url, headers)\n    .then(function(response) {\n      return response.json();\n    })\n    .then(function({ records }) {\n      return records;\n    })\n}\n\nfunction getDataFrom(tableName, id = 1) {\n  const url = `${baseUrl}/${tables[tableName]}/${tableName}?filterByFormula=(Id=${id})`;\n\n  return fetch(url, headers)\n    .then(function(response) {\n      return response.json();\n    })\n    .then(function({ records }) {\n      return records;\n      // then() returns a promise\n    })\n}\n\nexport { getDataFrom, getLastRecordId };","function randomNumber(max) {\n  return Math.ceil(Math.random() * max);\n}\n\n// The Math.random() function returns a number in the range 0–1 (inclusive of 0, but not 1) \n\nexport { randomNumber };","import { getDataFrom } from '../airtable/client.js';\nimport { randomNumber } from '../helpers/random-number.js';\n\nconst component = document.querySelector('#quote > app-block');\nconst lastId = 804;\nconst randomId = randomNumber(lastId);\n\ngetDataFrom('Quotes', randomId).then(function(data) {\n  component.setAttribute('title', data[0].fields.Author);\n  component.setAttribute('text', data[0].fields.Quote);\n  // component.querySelector('.title').innerHTML = data[0].fields.Author;\n  // component.querySelector('.text').innerHTML = data[0].fields.Quote;\n  // console.log(component.querySelector('.title'));\n})","import { getDataFrom, getLastRecordId } from '../airtable/client.js';\nimport { randomNumber } from '../helpers/random-number.js';\n\nconst component = document.querySelector('#principle > app-block');\n\ngetLastRecordId('Principles')\n  .then(function(data) {\n    // Get the last Id from the Principles table\n    return data[0].fields.Id\n  })\n  .then(function(lastId) {\n    // Generate a randon number using this id as upper bound\n    const id = randomNumber(lastId);\n    // Fetching data associated to this id\n    return getDataFrom('Principles', id)\n  })\n  .then(function(data) {\n    // Updating component with data\n    const title = `${data[0].fields.Title} - ${data[0].fields.Author}`\n    component.setAttribute('title', title);\n    component.setAttribute('text', data[0].fields.Principle);\n  })","import { AppBlock } from './components/block.js';\n\nimport { setText, setTitle } from './initialisers/init-counter.js';\nimport './initialisers/init-quote.js';\nimport './initialisers/init-principle.js';\n\nwindow.customElements.define('app-block', AppBlock);\n\nwindow.setInterval(setText, 100);\nsetTitle();\n\n\n// To-Do\n// Create 1 quote & principle / day, no more. Even if page refreshes.\n\n// Redesign\n  // Add pattern in the background (Make padding bigger)\n  // Add loader in quote and principle\n\n// Ask birthday in a prompt window and store locally\n\n// Deploy on netlify\n\n// Have a read-only API key from airtable\n\n\n\n\n// DONE ///////////////////\n// Redraw layout. 7 * 7 \n  // principle is 4 wide / 7 high\n  // quote is 3 wide / 4 high\n  // counter is 3 wide / 3 high\n\n// Change style based on size attributes\n  // https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements#Using_the_lifecycle_callbacks\n\n// Make the last id programmatically set, not hard coded\n  // 1. Find what the last inserted record is thanks to the created field\n  // 2. Get the id from that\n  // 3. Generate a random ID from 1 and that id.\n  // 4. Inject the random id in the fetch request\n  // 5. Exclude empty field NOT({Author} = ''). Only common field to both tables.\n  // => Import Airtable.js to do so"]}